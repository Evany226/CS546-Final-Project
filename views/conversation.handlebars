<div class="temp"></div>
<main class="conv-container">
  <section class="user-panel">
    <div class="user-panel-header">
      <h2 class="user-panel-header-text">Messages</h2>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        class="create-msg-btn"
      ><title>email-plus-outline</title><path
          d="M13 19C13 18.66 13.04 18.33 13.09 18H4V8L12 13L20 8V13.09C20.72 13.21 21.39 13.46 22 13.81V6C22 4.9 21.1 4 20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H13.09C13.04 19.67 13 19.34 13 19M20 6L12 11L4 6H20M20 15V18H23V20H20V23H18V20H15V18H18V15H20Z"
        /></svg>
    </div>
    <div class="user-panel-body">
      <div class="create-conv-wrapper">
        <form class="create-conv-form" method="POST" action="/conversations">
          <input
            class="create-conv-input"
            name="username"
            type="text"
            placeholder="Search for a user"
          />
          <button class="create-conv-btn" type="submit">Create</button>
        </form>
        {{#if error}}
          <p class="error-alert">{{error}}</p>
        {{/if}}
      </div>
      <ul class="user-panel-list">
        {{#each conversations}}
          <li class="user-panel-list-item">
            <a class="user-panel-link" href="/conversations/{{this.id}}">
              <div class="user-pfp">
              <img
                class="user-pfp-img"
                src="https://via.placeholder.com/150"
                alt="User Profile Picture"
              />
            </div>
            <div class="user-info">
              <h3 class="user-name">{{this.otherUsername}}</h3>
              <p class="user-message">Hey, how are you?</p>
            </div>
            </a>
          </li>
        {{/each}}
      </ul>
    </div>

  </section>
  <section class="chat-panel">
    {{#if isIndividual}}
      <div class="chat-panel-header">
        <h2 class="chat-panel-header-text">John Doe</h2>
      </div>
    {{/if}}
    <ul class="chat-panel-body">
      {{#if messages}}
        {{#each messages}}
          {{#if sentByCurrUser}}
            <li class="chat-message-r">
              <div class="chat-message-content-r">
                  <p class="chat-message-text">{{this.content}}</p>
              </div>
            </li>
          {{else}}
            <li class="chat-message-l">
              <div class="chat-pfp">
                <img
                  class="chat-pfp-img"
                  src="https://via.placeholder.com/150"
                  alt="User Profile Picture"
                />
              </div>
              <div class="chat-message-content-l">
                  <p class="chat-message-text">{{this.content}}</p>
              </div>
            </li>
          {{/if}}
        {{/each}}
      {{else}}
        <p class="no-messages">No messages yet</p>
      {{/if}}
    </ul>
    <form
      class="chat-form"
      method="POST"
      action="/conversations/{{this.currConvId}}"
    >
      {{#if isIndividual}}
        <div class="chat-input-wrapper">
          <input
            class="chat-input"
            type="text"
            placeholder="Message John Doe"
            name="message"
          />
          <button class="chat-button" type="submit">Send</button>
        </div>
      {{/if}}

    </form>
  </section>
</main>

{{> (lookup . 'partial') }}